
var cfaq_isLinking=false;var cfaq_links=new Array();var cfaq_linkCurrentIndex=-1;var cfaq_canvasTimer;var cfaq_mouseX,cfaq_mouseY;var cfaq_linkGradientIndex=1;var cfaq_itemWinTimer;var cfaq_currentDomElement=false;var cfaq_currentStep=false;var cfaq_currentStepID=0;var cfaq_lock=false;var cfaq_defaultStep=false;var cfaq_steps=false;var cfaq_params;var cfaq_currentLinkIndex=0;var cfaq_settings;var cfaq_formfield;var cfaq_currentFaqID=0;var cfaq_actTimer;var cfaq_currentFaq=false;var cfaq_currentItemID=0;var cfaq_canSaveLink=true;var cfaq_currentFaqID=false;cfaq_data=cfaq_data[0];jQuery(document).ready(function(){jQuery("#cfaq_loader").remove();jQuery("#wpcontent").append('<div id="cfaq_loader"><div class="cfaq_spinner"><div class="double-bounce1"></div><div class="double-bounce2"></div></div></div>');jQuery("#cfaq_loader .cfaq_spinner").css({top:jQuery(window).height()/2-jQuery("#wpadminbar").height()/2});jQuery(window).resize(function(){jQuery("#cfaq_loader .cfaq_spinner").css({top:jQuery(window).height()/2-jQuery("#wpadminbar").height()/2});jQuery("#cfaq_bootstraped").css({minHeight:jQuery("#wpcontent").height()})});jQuery("#cfaq_bootstraped").css({minHeight:jQuery("#wpcontent").height()});jQuery("#cfaq_stepsContainer").droppable({drop:function(b,c){var a=jQuery(c.draggable[0]);jQuery.ajax({url:ajaxurl,type:"post",data:{action:"cfaq_saveStepPosition",stepID:a.attr("data-stepid"),posX:parseInt(a.css("left")),posY:parseInt(a.css("top"))}})}});jQuery("#cfaq_bootstraped [data-toggle='switch']").bootstrapSwitch();jQuery(".imageBtn").click(function(){cfaq_formfield=jQuery(this).prev("input");tb_show("","media-upload.php?TB_iframe=true");return false});window.old_tb_remove=window.tb_remove;window.tb_remove=function(){window.old_tb_remove();cfaq_formfield=null};window.original_send_to_editor=window.send_to_editor;window.send_to_editor=function(a){if(cfaq_formfield){var b=jQuery("img",a).attr("alt");fileurl=jQuery("img",a).attr("src");if(jQuery("img",a).length==0){fileurl=jQuery(a).attr("src");b=jQuery(a).attr("alt")}cfaq_formfield.val(fileurl);cfaq_formfield.trigger("keyup");tb_remove()}else{window.original_send_to_editor(a)}};jQuery("#wpwrap").css({height:jQuery("#cfaq_bootstraped").height()+48});setInterval(function(){if(jQuery("#cfaq_winStep").css("display")=="block"){jQuery("#wpwrap").css({height:jQuery("#cfaq_winStep").height()+48})}else{jQuery("#wpwrap").css({height:jQuery("#cfaq_bootstraped").height()+48})}},1000);cfaq_canvasTimer=setInterval(cfaq_updateStepCanvas,30);jQuery(document).mousemove(function(a){if(cfaq_isLinking){cfaq_mouseX=a.pageX-jQuery("#cfaq_stepsContainer").offset().left;cfaq_mouseY=a.pageY-jQuery("#cfaq_stepsContainer").offset().top}});jQuery(window).resize(cfaq_updateStepsDesign);cfaq_itemWinTimer=setInterval(cfaq_updateWinItemPosition,30);if(jQuery("#cfaq_winActivation").is('[data-show="true"]')&&document.referrer.indexOf("admin.php?page=cfaq_menu")<0){jQuery("#cfaq_winActivation .modal-dialog").hover(function(){jQuery(this).addClass("cfaq_hover")},function(){jQuery(this).removeClass("cfaq_hover")});cfaq_lock=true;jQuery("#cfaq_closeWinActivationBtn").click(function(){if(!cfaq_lock){jQuery("#cfaq_winActivation").modal("hide")}});jQuery("#cfaq_closeWinActivationBtn .cfaq_text").data("num",10).html("Wait 10 seconds");cfaq_actTimer=setInterval(function(){var a=jQuery("#cfaq_closeWinActivationBtn .cfaq_text").data("num");a--;if(a>0){jQuery("#cfaq_closeWinActivationBtn .cfaq_text").data("num",a).html("Wait "+a+" seconds")}else{jQuery("#cfaq_closeWinActivationBtn").removeClass("disabled");cfaq_lock=false;jQuery("#cfaq_closeWinActivationBtn .cfaq_text").data("num","").html("Close")}},1000)}else{jQuery("#cfaq_winActivation").attr("data-show","false")}jQuery("#cfaq_winActivation").on("hide.bs.modal",function(a){if(cfaq_lock&&!jQuery("#cfaq_winActivation .modal-dialog").is(".cfaq_hover")){a.preventDefault()}});jQuery(document).mousedown(function(a){if(a.button==2&&cfaq_isLinking){cfaq_isLinking=false}});jQuery(".form-group").each(function(){var a=this;if(jQuery(a).find("small").length>0&&jQuery(a).find(".form-control").length>0){jQuery(this).find(".form-control").tooltip({title:jQuery(a).find("small").html()})}});jQuery("#cfaq_bootstraped [data-toggle='switch']").bootstrapSwitch();jQuery("#cfaq_bootstraped").find('input[type="checkbox"]').each(function(){if(jQuery(this).is('[data-toggle="switch"]')){if(jQuery(this).closest(".form-group").find("small").length>0){jQuery(this).closest(".has-switch").tooltip({title:jQuery(this).closest(".form-group").find("small").html()})}}});jQuery("#cfaq_stepDescription").summernote({height:200,minHeight:null,maxHeight:null,});jQuery("#cfaq_txtNewQuestion").summernote({height:140,minHeight:null,maxHeight:null,});jQuery(".imageBtn").click(function(){cfaq_formfield=jQuery(this).prev("input");tb_show("","media-upload.php?TB_iframe=true");return false});jQuery("#cfaq_winActivation").modal();jQuery('[data-toggle="tooltip"]').tooltip();cfaq_loadSettings()});function cfaq_onGoogleFontChange(){if(jQuery('#cfaq_faqFields input[name="useGoogleFont"]').is(":checked")){jQuery('#cfaq_faqFields input[name="googleFontName"]').closest(".form-group").slideDown()}else{jQuery('#cfaq_faqFields input[name="googleFontName"]').closest(".form-group").slideUp()}}function cfaq_onSendEmailChanged(){if(jQuery('#cfaq_faqFields input[name="sendEmail"]').is(":checked")){jQuery('#cfaq_faqFields input[name="emailSubject"]').closest(".form-group").slideDown();jQuery('#cfaq_faqFields input[name="email"]').closest(".form-group").slideDown()}else{jQuery('#cfaq_faqFields input[name="emailSubject"]').closest(".form-group").slideUp();jQuery('#cfaq_faqFields input[name="email"]').closest(".form-group").slideUp()}}function cfaq_getStepByID(b){var a=false;jQuery.each(cfaq_steps,function(c){if(this.id==b){a=this}});return a}function cfaq_showLoader(){jQuery("body").animate({scrollTop:0},250);jQuery("#cfaq_loader").fadeIn()}function cfaq_showShortcodeWin(a){if(!a){a=cfaq_currentFaqID}jQuery("#cfaq_shortcode_1").val('[clever_faq faq="'+a+'"]');jQuery("#cfaq_winShortcode").modal("show")}function cfaq_checkEmail(a){if(a.indexOf("@")!="-1"&&a.indexOf(".")!="-1"&&a!=""){return true}return false}function cfaq_addStep(c){var e="";var a=0;if(!c.content){e=c}else{e=c.title}if(e.length>49){e=e.substr(0,46)+"..."}var b=jQuery('<div class="cfaq_stepBloc palette palette-clouds"><div class="cfaq_stepBlocWrapper"><h4>'+e+'</h4></div><a href="javascript:" class="cfaq_btnEdit" title="'+cfaq_data.texts.tip_editStep+'"><span class="glyphicon glyphicon-pencil"></span></a><a href="javascript:" class="cfaq_btnSup" title="'+cfaq_data.texts.tip_delStep+'"><span class="glyphicon glyphicon-trash"></span></a><a href="javascript:" class="cfaq_btnDup" title="'+cfaq_data.texts.tip_duplicateStep+'"><span class="glyphicon glyphicon-duplicate"></span></a><a href="javascript:" class="cfaq_btnLink" title="'+cfaq_data.texts.tip_linkStep+'"><span class="glyphicon glyphicon-link"></span></a><a href="javascript:" class="cfaq_btnStart" title="'+cfaq_data.texts.tip_flagStep+'"><span class="glyphicon glyphicon-flag"></span></a></div>');if(c.content&&c.content.start==1){b.find(".cfaq_btnStart").addClass("cfaq_selected");b.addClass("cfaq_selected")}if(c.elementID){b.attr("id",c.elementID)}else{b.uniqueId()}b.children("a.cfaq_btnEdit").click(function(){cfaq_openWinStep(jQuery(this).parent().attr("data-stepid"))});b.children("a.cfaq_btnLink").click(function(){cfaq_startLink(jQuery(this).parent().attr("id"))});b.children("a.cfaq_btnSup").click(function(){cfaq_removeStep(jQuery(this).parent().attr("data-stepid"))});b.children("a.cfaq_btnDup").click(function(){cfaq_duplicateStep(jQuery(this).parent().attr("data-stepid"))});b.children("a.cfaq_btnStart").click(function(){cfaq_showLoader();jQuery(".cfaq_stepBloc[data-stepid]").find(".cfaq_btnStart").removeClass("cfaq_selected");jQuery(".cfaq_stepBloc[data-stepid]").find(".cfaq_btnStart").closest(".cfaq_stepBloc").removeClass("cfaq_selected");jQuery.each(cfaq_steps,function(){var h=this;if(h.id!=jQuery(this).parent().attr("data-stepid")&&h.content.start==1){h.content.start=0;jQuery.ajax({url:ajaxurl,type:"post",data:{action:"cfaq_saveStep",id:h.id,start:0,faqID:cfaq_currentFaqID,content:JSON.stringify(h.content)}})}});jQuery(this).addClass("cfaq_selected");jQuery(this).closest(".cfaq_stepBloc").addClass("cfaq_selected");var g=cfaq_getStepByID(jQuery(this).parent().attr("data-stepid"));g.content.start=1;jQuery.ajax({url:ajaxurl,type:"post",data:{action:"cfaq_saveStep",id:c.id,start:1,faqID:cfaq_currentFaqID,content:JSON.stringify(g.content)},success:function(){cfaq_loadFaq(cfaq_currentFaqID)}})});b.draggable({containment:"parent",handle:".cfaq_stepBlocWrapper"});b.children(".cfaq_stepBlocWrapper").click(function(){if(cfaq_isLinking){cfaq_stopLink(b)}});var f=10,d=10;if(c.content&&c.content.previewPosX){f=c.content.previewPosX;d=c.content.previewPosY}else{f=jQuery("#cfaq_stepsOverflow").scrollLeft()+jQuery("#cfaq_stepsOverflow").width()/2-64;d=jQuery("#cfaq_stepsOverflow").scrollTop()+jQuery("#cfaq_stepsOverflow").height()/2-64}b.hide();jQuery("#cfaq_stepsContainer").append(b);b.css({left:(f)+"px",top:d+"px"});b.fadeIn();setTimeout(cfaq_updateStepsDesign,250);jQuery(".cfaq_btnWinClose").parent().click(function(){cfaq_closeWin(jQuery(this).parents(".cfaq_window"))});if(jQuery("#cfaq_stepsContainer .cfaq_stepBloc").length==0){a=1}if(c.id){b.attr("data-stepid",c.id)}else{var e="";if(c.content&&c.content.question){e=c.content.title}jQuery.ajax({url:ajaxurl,type:"post",data:{action:"cfaq_addStep",elementID:b.attr("id"),faqID:cfaq_currentFaqID,previewPosX:f,previewPosY:d,start:a,title:e},success:function(g){g=jQuery.parseJSON(g);b.attr("data-stepid",g.id);if(g.start==1){b.find(".cfaq_btnStart").addClass("cfaq_selected");b.addClass("cfaq_selected")}cfaq_steps.push({content:g})}})}}function cfaq_saveStep(){cfaq_showLoader();var stepData={};jQuery("#cfaq_stepTabGeneral").find("input,select,textarea").each(function(){if(!jQuery(this).is('[data-toggle="switch"]')){if(jQuery(this).attr("name")!="cfaq_answer"){eval("stepData."+jQuery(this).attr("name")+" = jQuery(this).val();")}}else{var value=0;if(jQuery(this).is(":checked")){value=1}eval("stepData."+jQuery(this).attr("name")+" = value;")}});stepData.action="cfaq_saveStep";stepData.faqID=cfaq_currentFaqID;stepData.id=cfaq_currentStepID;stepData.description=jQuery("#cfaq_stepDescription").code();var itemsList="";jQuery('#cfaq_itemsTable tbody tr[data-itemid] td input[name="cfaq_answer"]').each(function(){itemsList+=jQuery(this).val()+"°"+jQuery(this).closest("tr").attr("data-itemid")+"|"});if(itemsList.length>0){itemsList=itemsList.substr(0,itemsList.length-1)}stepData.itemsList=itemsList;jQuery('.cfaq_stepBloc[data-stepid="'+cfaq_currentFaqID+'"] h4').html(stepData.title);cfaq_updateStepsDesign();jQuery.ajax({url:ajaxurl,type:"post",data:stepData,success:function(stepID){cfaq_loadFaq(cfaq_currentFaqID);cfaq_closeWin(jQuery("#cfaq_winStep"))}})}function cfaq_removeStep(b){var a=0;jQuery('.cfaq_stepBloc[data-stepid="'+b+'"]').remove();jQuery.ajax({url:ajaxurl,type:"post",data:{action:"cfaq_removeStep",stepID:b},success:function(){}})}function cfaq_updateStepsDesign(){jQuery("#wpwrap").css({height:jQuery("#cfaq_bootstraped").height()+48});jQuery("#cfaq_stepsCanvas").attr("width",jQuery("#cfaq_stepsContainer").outerWidth());jQuery("#cfaq_stepsCanvas").attr("height",jQuery("#cfaq_stepsContainer").outerHeight());jQuery("#cfaq_stepsCanvas").css({width:jQuery("#cfaq_stepsContainer").outerWidth(),height:jQuery("#cfaq_stepsContainer").outerHeight()});jQuery(".cfaq_stepBloc > .cfaq_stepBlocWrapper > h4").each(function(){jQuery(this).css("margin-top",0-jQuery(this).height()/2)})}function cfaq_repositionLinkPoint(c){var e=cfaq_links[c];var a=(jQuery("#"+e.originID).offset().left-jQuery("#cfaq_stepsContainer").offset().left)+jQuery("#"+e.originID).width()/2;var d=(jQuery("#"+e.originID).offset().top-jQuery("#cfaq_stepsContainer").offset().top)+jQuery("#"+e.originID).height()/2;var b=(jQuery("#"+e.destinationID).offset().left-jQuery("#cfaq_stepsContainer").offset().left)+jQuery("#"+e.destinationID).width()/2;var f=(jQuery("#"+e.destinationID).offset().top-jQuery("#cfaq_stepsContainer").offset().top)+jQuery("#"+e.destinationID).height()/2;var h=a+(b-a)/2;var g=d+(f-d)/2;jQuery.each(cfaq_links,function(j){if(this.originID==e.destinationID&&this.destinationID==e.originID&&j<c){h+=15;g+=15}});jQuery('.cfaq_linkPoint[data-linkindex="'+c+'"]').css({left:h+"px",top:g+"px"})}function cfaq_loadSettings(){jQuery.ajax({url:ajaxurl,type:"post",data:{action:"cfaq_loadSettings"},success:function(a){a=jQuery.parseJSON(a);cfaq_settings=a;jQuery("#cfaq_loader").fadeOut()}})}function cfaq_duplicateStep(a){cfaq_showLoader();jQuery.ajax({url:ajaxurl,type:"post",data:{action:"cfaq_duplicateStep",stepID:a},success:function(b){cfaq_loadFaq(cfaq_currentFaqID)}})}function cfaq_updateStepCanvas(){cfaq_linkGradientIndex++;if(cfaq_linkGradientIndex>=30){cfaq_linkGradientIndex=1}var a=jQuery("#cfaq_stepsCanvas").get(0).getContext("2d");a.clearRect(0,0,jQuery("#cfaq_stepsCanvas").attr("width"),jQuery("#cfaq_stepsCanvas").attr("height"));jQuery.each(cfaq_links,function(m){var p=this;if(p.destinationID&&jQuery("#"+p.originID).length>0&&jQuery("#"+p.destinationID).length>0){var f=parseInt(jQuery("#"+p.originID).css("left"))+jQuery("#"+p.originID).outerWidth()/2+22;var e=parseInt(jQuery("#"+p.originID).css("top"))+jQuery("#"+p.originID).outerHeight()/2+22;var k=parseInt(jQuery("#"+p.destinationID).css("left"))+jQuery("#"+p.destinationID).outerWidth()/2+22;var h=parseInt(jQuery("#"+p.destinationID).css("top"))+jQuery("#"+p.destinationID).outerHeight()/2+22;var j=a.createLinearGradient(f,e,k,h);var g=false;var i=cfaq_linkGradientIndex/30;var o=i;var n=i+0.1;var l=i+0.2;a.lineWidth=4;if(n>1){n=0;l=0.2}if(l>1){l=0}j.addColorStop(o,"#bdc3c7");j.addColorStop(n,"#1ABC9C");j.addColorStop(l,"#bdc3c7");a.strokeStyle=j;a.beginPath();a.moveTo(f,e);a.lineTo(k,h);a.stroke();if(jQuery('.cfaq_linkPoint[data-linkindex="'+m+'"]').length==0){var q=jQuery('<a href="javascript:" data-linkindex="'+m+'" class="cfaq_linkPoint"><span class="glyphicon glyphicon-pencil"></span></a>');jQuery("#cfaq_stepsContainer").append(q);q.click(function(){cfaq_openWinLink(jQuery(this))})}cfaq_repositionLinkPoint(m)}else{jQuery('.cfaq_linkPoint[data-linkindex="'+m+'"]').remove()}});if(cfaq_isLinking){var b=jQuery("#"+cfaq_links[cfaq_linkCurrentIndex].originID);var d=b.position().left+jQuery("#cfaq_stepsOverflow").scrollLeft()+b.outerWidth()/2;var c=b.position().top+jQuery("#cfaq_stepsOverflow").scrollTop()+b.outerHeight()/2;a.strokeStyle="#bdc3c7";a.lineWidth=4;a.beginPath();a.moveTo(d,c);a.lineTo(cfaq_mouseX,cfaq_mouseY);a.stroke()}}function cfaq_removeItem(a){jQuery('#cfaq_itemsTable tbody tr[data-itemid="'+a+'"] td input[name="cfaq_answer"]').closest("tr").remove();jQuery.ajax({url:ajaxurl,type:"post",data:{action:"cfaq_removeItem",itemID:a,stepID:cfaq_currentStepID,faqID:cfaq_currentFaqID},success:function(){}})}function cfaq_addItem(){var a=jQuery("<tr></tr>");a.append('<td><a href="javascript:">'+cfaq_data.texts.newAnswer+'</a><input type="text" class="form-control" value="'+cfaq_data.texts.newAnswer+'" style="display:none;"  name="cfaq_answer" /></td>');a.append('<td><a href="javascript:" class="btn btn-primary btn-circle"><span class="glyphicon glyphicon-pencil"></span></a><a href="javascript:" class="btn btn-danger btn-circle"><span class="glyphicon glyphicon-trash"></span></a></td>');jQuery("#cfaq_itemsTable tbody").append(a);jQuery.ajax({url:ajaxurl,type:"post",data:{action:"cfaq_addItem"},success:function(b){a.attr("data-itemid",b);a.find("td:eq(0) > a:eq(0)").click(function(){cfaq_editItem(b)});a.find("td:eq(1) > a:eq(0)").click(function(){cfaq_editItem(b)});a.find("td:eq(1) > a:eq(1)").click(function(){cfaq_removeItem(b)})}})}function cfaq_editItem(a){jQuery('#cfaq_itemsTable tbody tr[data-itemid="'+a+'"] td input[name="cfaq_answer"]').prev().hide();jQuery('#cfaq_itemsTable tbody tr[data-itemid="'+a+'"] td input[name="cfaq_answer"]').show();jQuery('#cfaq_itemsTable tbody tr[data-itemid="'+a+'"] td input[name="cfaq_answer"]').val(jQuery('#cfaq_itemsTable tbody tr[data-itemid="'+a+'"] td input[name="cfaq_answer"]').prev().html());jQuery('#cfaq_itemsTable tbody tr[data-itemid="'+a+'"] td input[name="cfaq_answer"]').focusout(function(){var b=jQuery(this).val();if(b.length==0){jQuery(this).addClass("cfaq-error")}else{jQuery(this).removeClass("cfaq-error");jQuery(this).hide();jQuery(this).prev().html(jQuery(this).val());jQuery(this).prev().show()}})}function cfaq_addFaq(){cfaq_showLoader();jQuery.ajax({url:ajaxurl,type:"post",data:{action:"cfaq_addFaq"},success:function(a){cfaq_loadFaq(a)}})}function cfaq_loadFaq(faqID){cfaq_currentFaqID=faqID;jQuery("#cfaq_btnLogsFaq").attr("data-faqid",faqID);cfaq_showLoader();jQuery("#cfaq_stepsContainer .cfaq_stepBloc,.cfaq_loadSteps,.cfaq_linkPoint").remove();jQuery("#cfaq_logsBtn").attr("data-faqid",faqID);jQuery("#cfaq_btnPreview").attr("href",cfaq_data.websiteUrl+"?cfaq_action=preview&faq="+faqID);jQuery.ajax({url:ajaxurl,type:"post",data:{action:"cfaq_loadFaq",faqID:faqID},success:function(rep){rep=JSON.parse(rep);cfaq_currentFaq=rep;cfaq_params=rep.params;cfaq_steps=rep.steps;cfaq_questions=rep.questions;jQuery("#cfaq_faqFields").find("input,select,textarea").each(function(){if(jQuery(this).is('[data-toggle="switch"]')){var value=false;eval("if(rep.faq."+jQuery(this).attr("name")+" == 1 && jQuery(this).attr('checked') != 'checked'){jQuery(this).trigger('click');}");eval("if(rep.faq."+jQuery(this).attr("name")+" == 0 && jQuery(this).attr('checked') == 'checked'){jQuery(this).trigger('click');}")}else{eval("jQuery(this).val(rep.faq."+jQuery(this).attr("name")+");")}});jQuery.each(rep.steps,function(index){var step=this;step.content=JSON.parse(step.content);cfaq_addStep(step)});jQuery.each(rep.links,function(index){var link=this;link.originID=jQuery('.cfaq_stepBloc[data-stepid="'+link.originID+'"]').attr("id");link.destinationID=jQuery('.cfaq_stepBloc[data-stepid="'+link.destinationID+'"]').attr("id");link.conditions=JSON.parse(link.conditions);cfaq_links[index]=link});jQuery("#cfaq_newQuestions tbody").html("");jQuery.each(rep.questions,function(index){jQuery("#cfaq_newQuestions tbody").append('<tr data-questionid="'+this.id+'"><td>'+this.date+"</td><td>"+this.question+"</td><td>"+this.email+'</td><td><a href="javascript:" onclick="cfaq_createQuestion('+this.id+",'"+this.question+'\');" class="btn btn-primary btn-circle"><span class="glyphicon glyphicon-plus"></span></a><a href="javascript:" onclick="cfaq_removeQuestion('+this.id+');" class="btn btn-danger btn-circle"><span class="glyphicon glyphicon-trash"></span></a></td></tr>')});jQuery("#cfaq_txtNewQuestion").code(rep.faq.txtNewQuestion);jQuery("#cfaq_panelPreview").show();jQuery("#cfaq_panelFaqsList").hide();jQuery("#cfaq_loader").delay(1000).fadeOut();jQuery(".colorpick").each(function(){var $this=jQuery(this);if(jQuery(this).prev(".cfaq_colorPreview").length==0){jQuery(this).before('<div class="cfaq_colorPreview" style="background-color:#'+$this.val().substr(1,7)+'"></div>')}jQuery(this).prev(".cfaq_colorPreview").click(function(){jQuery(this).next(".colorpick").trigger("click")});jQuery(this).colpick({color:$this.val().substr(1,7),onChange:function(hsb,hex,rgb,el,bySetColor){jQuery(el).val("#"+hex);jQuery(el).prev(".cfaq_colorPreview").css({backgroundColor:"#"+hex})}})});jQuery('#cfaq_faqFields input[name="useGoogleFont"]').bootstrapSwitch("onSwitchChange",cfaq_onGoogleFontChange);jQuery('#cfaq_faqFields input[name="sendEmail"]').bootstrapSwitch("onSwitchChange",cfaq_onSendEmailChanged);cfaq_onGoogleFontChange();cfaq_onSendEmailChanged();cfaq_updateStepsDesign();setTimeout(function(){cfaq_updateStepsDesign()},250)}})}function cfaq_createQuestion(a,b){cfaq_addStep({title:b,content:{question:b,title:b}})}function cfaq_removeFaq(a){cfaq_showLoader();jQuery.ajax({url:ajaxurl,type:"post",data:{action:"cfaq_removeFaq",faqID:a},success:function(){cfaq_returnToList()}})}function cfaq_returnToList(){cfaq_showLoader();document.location.href=document.location.href}function cfaq_updateWinItemPosition(){if(jQuery("#cfaq_winStep").css("display")!="none"){var a=jQuery("#"+jQuery("#cfaq_itemWindow").attr("data-item"));if(a.length>0){jQuery("#cfaq_itemWindow").css({top:a.offset().top-jQuery("#cfaq_bootstraped.cfaq_bootstraped").offset().top+a.outerHeight()+12,left:a.offset().left-jQuery("#cfaq_bootstraped.cfaq_bootstraped").offset().left})}else{jQuery("#cfaq_itemWindow").fadeOut()}}else{jQuery("#cfaq_itemWindow").fadeOut()}}function cfaq_existInDefaultStep(b){var a=false;jQuery.each(cfaq_defaultStep.interactions,function(){var c=this;if(c.itemID==b){a=true}});return a}function cfaq_closeWin(a){a.fadeOut();jQuery("#cfaq_stepsContainer").slideDown();setTimeout(function(){cfaq_updateStepsDesign()},250)}function cfaq_startLink(a){cfaq_isLinking=true;cfaq_linkCurrentIndex=cfaq_links.length;cfaq_links.push({originID:a,destinationID:null})}function cfaq_stopLink(a){cfaq_isLinking=false;var b=false;jQuery.each(cfaq_links,function(){if(this.originID==cfaq_links[cfaq_linkCurrentIndex].originID&&this.destinationID==a.attr("id")){b=this}});if(!b){cfaq_showLoader();cfaq_links[cfaq_linkCurrentIndex].destinationID=a.attr("id");jQuery.ajax({url:ajaxurl,type:"post",data:{action:"cfaq_newLink",faqID:cfaq_currentFaqID,originStepID:jQuery("#"+cfaq_links[cfaq_linkCurrentIndex].originID).attr("data-stepid"),destinationStepID:jQuery("#"+cfaq_links[cfaq_linkCurrentIndex].destinationID).attr("data-stepid")},success:function(c){cfaq_links[cfaq_linkCurrentIndex].id=c;cfaq_loadFaq(cfaq_currentFaqID)}})}else{jQuery.grep(cfaq_links,function(c){return c!=b})}}function cfaq_removeAllSteps(){cfaq_showLoader();jQuery.ajax({url:ajaxurl,type:"post",data:{action:"cfaq_removeAllSteps",faqID:cfaq_currentFaqID},success:function(){cfaq_loadFaq(cfaq_currentFaqID)}})}function cfaq_openWinStep(stepID){cfaq_currentStepID=stepID;cfaq_showLoader();jQuery("#cfaq_winStep").find('.switch [data-toggle="switch"]').bootstrapSwitch("destroy");jQuery("#cfaq_winStep").find('.switch > div > :not([data-toggle="switch"])').remove();jQuery("#cfaq_winStep").find('.switch [data-toggle="switch"]').unwrap().unwrap();jQuery(".cfaq_stepIDUrl").html(stepID);jQuery("#cfaq_itemsTable tbody").html("");if(cfaq_currentStepID==0){jQuery("#cfaq_itemsList").hide()}else{jQuery.ajax({url:ajaxurl,type:"post",data:{action:"cfaq_loadStep",stepID:stepID},success:function(rep){rep=jQuery.parseJSON(rep);step=rep.step;cfaq_currentStep=rep;jQuery("#cfaq_stepTabGeneral").find("input,select,textarea").each(function(){if(jQuery(this).is('[data-toggle="switch"]')){var value=false;eval("if(step."+jQuery(this).attr("name")+" == 1 && jQuery(this).attr('checked') != 'checked'){jQuery(this).trigger('click');}");eval("if(step."+jQuery(this).attr("name")+" == 0 && jQuery(this).attr('checked') == 'checked'){jQuery(this).trigger('click');}")}else{eval("jQuery(this).val(step."+jQuery(this).attr("name")+");")}});jQuery("#cfaq_stepDescription").code(step.description);jQuery.each(rep.items,function(){var item=this;var $tr=jQuery('<tr data-itemid="'+item.id+'"></tr>');$tr.append('<td><a href="javascript:"  onclick="cfaq_editItem('+item.id+');">'+item.title+'</a><input type="text" class="form-control" value="'+item.title+'" style="display:none;" name="cfaq_answer" /></td>');$tr.append('<td style="min-width: 130px;"><a href="javascript:" onclick="cfaq_editItem('+item.id+');" class="btn btn-primary btn-circle"><span class="glyphicon glyphicon-pencil"></span></a><a href="javascript:" onclick="cfaq_removeItem('+item.id+');" class="btn btn-danger btn-circle"><span class="glyphicon glyphicon-trash"></span></a></td>');jQuery("#cfaq_itemsTable tbody").append($tr)});jQuery("#cfaq_itemsTable tbody").sortable({helper:function(e,tr){var $originals=tr.children();var $helper=tr.clone();$helper.children().each(function(index){jQuery(this).width($originals.eq(index).width())});return $helper},stop:function(event,ui){var items="";jQuery("#cfaq_itemsTable tbody tr[data-itemid]").each(function(i){items+=jQuery(this).attr("data-itemid")+","});if(items.length>0){items=items.substr(0,items.length-1)}jQuery.ajax({url:ajaxurl,type:"post",data:{action:"cfaq_changeItemsOrders",items:items}})}});jQuery("#cfaq_itemsList").show();jQuery("#cfaq_btns").html("");jQuery("#cfaq_winStep").show();jQuery("#cfaq_stepsContainer").slideUp();jQuery("#cfaq_loader").fadeOut();jQuery("#wpwrap").css({height:jQuery("#cfaq_winStep").height()+48})}})}}function cfaq_openWinLink(b){cfaq_currentLinkIndex=b.attr("data-linkindex");jQuery("#cfaq_winLink").attr("data-linkindex",b.attr("data-linkindex"));jQuery(".cfaq_conditionItem").remove();var e=jQuery("#"+cfaq_links[b.attr("data-linkindex")].originID).attr("data-stepid");var c=cfaq_getStepByID(e);var d=jQuery("#"+cfaq_links[b.attr("data-linkindex")].destinationID).attr("data-stepid");var a=cfaq_getStepByID(d);jQuery("#cfaq_linkInteractions").show();jQuery("#cfaq_linkOriginTitle").html(c.title);jQuery("#cfaq_linkDestinationTitle").html(a.title);jQuery.each(cfaq_links[cfaq_currentLinkIndex].conditions,function(){cfaq_addLinkInteraction(this)});jQuery("#cfaq_linkOperator").val(cfaq_links[cfaq_currentLinkIndex].operator);jQuery("#cfaq_winLink").fadeIn(250);setTimeout(cfaq_updateStepsDesign,255);setTimeout(function(){jQuery("#wpwrap").css({height:jQuery("#cfaq_bootstraped").height()+48})},300)}function cfaq_addLinkInteraction(d){var g=jQuery('<tr class="cfaq_conditionItem"></tr>');var b=jQuery('<select class="cfaq_conditionSelect form-control"></select>');jQuery.each(cfaq_steps,function(){var k=this;jQuery.each(k.items,function(){var l=this;var m=k.id+"_"+l.id;b.append('<option value="'+m+'" data-type="'+l.type+'">'+k.title+' : " '+l.title+' "</option>')})});var h=jQuery('<select class="cfaq_conditionoperatorSelect form-control"></select>');b.change(function(){var o=b.val().substr(0,b.val().indexOf("_"));var n=b.val().substr(b.val().indexOf("_")+1,b.val().length);var m=false;jQuery.each(cfaq_steps,function(){var p=this;if(p.id==o){jQuery.each(p.items,function(){if(this.id==n){m=this}})}});var k=jQuery(this).parent().parent().find(".cfaq_conditionoperatorSelect");k.find("option").remove();if(b.find("option:selected").is("[data-static]")){var l=cfaq_conditionGetOperators({type:b.find("option:selected").attr("data-type")},b)}else{var l=cfaq_conditionGetOperators(m,b)}jQuery.each(l,function(){k.append('<option value="'+this.value+'"  data-variable="'+this.hasVariable+'">'+this.text+"</option>")});h.change()});if(d){b.val(d.interaction)}b.change();if(b.find("option:selected").is("[data-static]")){var j=cfaq_conditionGetOperators({type:b.find("option:selected").attr("data-type")},b)}else{var f=b.val().substr(0,b.val().indexOf("_"));var a=b.val().substr(b.val().indexOf("_")+1,b.val().length);var i=false;jQuery.each(cfaq_steps,function(){var k=this;if(k.id==f){jQuery.each(k.items,function(){if(this.id==a){i=this}})}});var j=cfaq_conditionGetOperators(i,b)}jQuery.each(j,function(){h.append('<option value="'+this.value+'" data-variable="'+this.hasVariable+'">'+this.text+"</option>")});h.change(function(){cfaq_linksUpdateFields(jQuery(this))});var e=jQuery("<td></td>");e.append(b);g.append(e);var c=jQuery("<td></td>");c.append(h);g.append(c);g.append('<td></td><td><a href="javascript:" class="cfaq_conditionDelBtn" onclick="cfaq_conditionRemove(this);"><span class="glyphicon glyphicon-remove"></span></a> </td>');if(d){h.val(d.action);h.change();if(d.value){h.closest(".cfaq_conditionItem").find(".cfaq_conditionValue").val(d.value)}setTimeout(function(){cfaq_linksUpdateFields(h,d);if(d.value){h.closest(".cfaq_conditionItem").find(".cfaq_conditionValue").val(d.value)}},500)}jQuery("#cfaq_conditionsTable tbody").append(g)}function cfaq_conditionGetOperators(c,b){var a=new Array();a.push({value:"clicked",text:cfaq_data.texts.isSelected});a.push({value:"unclicked",text:cfaq_data.texts.isUnselected});return a}function cfaq_conditionRemove(a){var b=jQuery(a);b.closest(".cfaq_conditionItem").remove()}function cfaq_linkSave(){if(cfaq_canSaveLink){cfaq_canSaveLink=false;setTimeout(function(){cfaq_canSaveLink=true},1500);cfaq_links[cfaq_currentLinkIndex].conditions=new Array();jQuery(".cfaq_conditionItem").each(function(){cfaq_links[cfaq_currentLinkIndex].conditions.push({interaction:jQuery(this).find(".cfaq_conditionSelect").val(),action:jQuery(this).find(".cfaq_conditionoperatorSelect").val(),value:jQuery(this).find(".cfaq_conditionValue").val()})});cfaq_links[cfaq_currentLinkIndex].operator=jQuery("#cfaq_linkOperator").val();var a=cfaq_links.slice();jQuery.each(a,function(){this.originID=jQuery("#"+this.originID).attr("data-stepid");this.destinationID=jQuery("#"+this.destinationID).attr("data-stepid")});jQuery.ajax({url:ajaxurl,type:"post",data:{action:"cfaq_saveLinks",faqID:cfaq_currentFaqID,links:JSON.stringify(a)},success:function(){cfaq_closeWin(jQuery("#cfaq_winLink"));cfaq_loadFaq(cfaq_currentFaqID)}})}}function cfaq_linkDel(){if(cfaq_canSaveLink){cfaq_canSaveLink=false;setTimeout(function(){cfaq_canSaveLink=true},1500);cfaq_links.splice(jQuery.inArray(cfaq_links[cfaq_currentLinkIndex],cfaq_links),1);var a=cfaq_links.slice();jQuery.each(a,function(){this.originID=jQuery("#"+this.originID).attr("data-stepid");this.destinationID=jQuery("#"+this.destinationID).attr("data-stepid")});jQuery.ajax({url:ajaxurl,type:"post",data:{action:"cfaq_saveLinks",faqID:cfaq_currentFaqID,links:JSON.stringify(a)},success:function(){cfaq_closeWin(jQuery("#cfaq_winLink"));cfaq_loadFaq(cfaq_currentFaqID)}})}}function cfaq_linksUpdateFields(e,d){e.closest(".cfaq_conditionItem").find(".cfaq_conditionValue").parent().remove();if(e.closest(".cfaq_conditionItem").find(".cfaq_conditionoperatorSelect option:selected").attr("data-variable")=="textfield"){if(e.closest(".cfaq_conditionItem").find(".cfaq_conditionValue").length==0){e.closest(".cfaq_conditionItem").children("td:eq(2)").html('<div><input type="text" placeholder="http://..." class="cfaq_conditionValue form-control" /> </div>')}}if(e.closest(".cfaq_conditionItem").find(".cfaq_conditionoperatorSelect option:selected").attr("data-variable")=="numberfield"){if(e.closest(".cfaq_conditionItem").find(".cfaq_conditionValue").length==0){e.closest(".cfaq_conditionItem").children("td:eq(2)").html('<div><input type="number" class="cfaq_conditionValue form-control" /> </div>')}}if(e.closest(".cfaq_conditionItem").find(".cfaq_conditionoperatorSelect option:selected").attr("data-variable")=="pricefield"){if(e.closest(".cfaq_conditionItem").find(".cfaq_conditionValue").length==0){e.closest(".cfaq_conditionItem").children("td:eq(2)").html('<div><input type="number" step="any" class="cfaq_conditionValue form-control" /> </div>')}}if(e.closest(".cfaq_conditionItem").find(".cfaq_conditionoperatorSelect option:selected").attr("data-variable")=="datefield"){if(e.closest(".cfaq_conditionItem").find(".cfaq_conditionValue").length==0){e.closest(".cfaq_conditionItem").children("td:eq(2)").html('<div><input type="text" step="any" class="cfaq_conditionValue form-control"/> </div>');e.closest(".cfaq_conditionItem").find(".cfaq_conditionValue").datepicker({dateFormat:"yy-mm-dd"})}}if(e.closest(".cfaq_conditionItem").find(".cfaq_conditionoperatorSelect option:selected").attr("data-variable")=="select"){var c="";var b=e.closest(".cfaq_conditionItem").find(".cfaq_conditionSelect");var h=b.val().substr(0,b.val().indexOf("_"));var g=b.val().substr(b.val().indexOf("_")+1,b.val().length);var f="";jQuery.each(cfaq_currentFaq.steps,function(){if(this.id==h){jQuery.each(this.items,function(){if(this.id==g){f=this.optionsValues}})}});var a=f.split("|");jQuery.each(a,function(){var j=this;if(j.indexOf(";;")>0){var i=j.split(";;");j=i[0]}if(j.length>0){f+='<option value="'+j+'">'+j+"</option>"}});if(e.closest(".cfaq_conditionItem").find(".cfaq_conditionValue").length==0){e.closest(".cfaq_conditionItem").children("td:eq(2)").html('<div><select class="cfaq_conditionValue form-control">'+f+"</select> </div>")}}if(d&&d.value){e.closest(".cfaq_conditionItem").find(".cfaq_conditionValue").val(d.value)}}function cfaq_duplicateFaq(a){cfaq_showLoader();jQuery.ajax({url:ajaxurl,type:"post",data:{action:"cfaq_duplicateFaq",faqID:a},success:function(b){document.location.href=document.location.href}})}function cfaq_selectPre(a){jQuery(a).select()}function cfaq_saveFaq(){if(jQuery('#cfaq_faqFields input[name="sendEmail"]').is(":checked")&&!cfaq_checkEmail(jQuery('#cfaq_faqFields input[name="email"]').val())){jQuery('#cfaq_faqFields input[name="email"]').closest(".form-group").addClass("has-error")}else{jQuery('#cfaq_faqFields input[name="email"]').closest(".form-group").removeClass("has-error");cfaq_showLoader();var faqData={};jQuery("#cfaq_faqFields").find("input,select,textarea").each(function(){if(!jQuery(this).is('[data-toggle="switch"]')){eval("faqData."+jQuery(this).attr("name")+" = jQuery(this).val();")}else{var value=0;if(jQuery(this).is(":checked")){value=1}eval("faqData."+jQuery(this).attr("name")+" = value;")}});faqData.action="cfaq_saveFaq";faqData.faqID=cfaq_currentFaqID;faqData.txtNewQuestion=jQuery("#cfaq_txtNewQuestion").code();jQuery.ajax({url:ajaxurl,type:"post",data:faqData,success:function(){jQuery("#cfaq_loader").fadeOut()}})}}function cfaq_exportFaqs(){cfaq_showLoader();jQuery.ajax({url:ajaxurl,type:"post",data:{action:"cfaq_exportFaqs"},success:function(a){jQuery("#cfaq_loader").fadeOut();if(a=="1"){jQuery("#cfaq_winExport").modal("show")}else{alert(cfaq_data.texts.errorExport)}}})}function cfaq_importFaqs(){cfaq_showLoader();jQuery("#cfaq_winImport").modal("hide");var a=new FormData(jQuery("#cfaq_winImportFaq")[0]);jQuery.ajax({url:ajaxurl,type:"post",xhr:function(){var b=jQuery.ajaxSettings.xhr();return b},success:function(b){if(b!="1"){jQuery("#cfaq_loader").fadeOut();alert(cfaq_data.texts.errorImport)}else{document.location.href=document.location.href}},data:a,cache:false,contentType:false,processData:false})}function cfaq_removeQuestion(a){jQuery('#cfaq_newQuestions tr[data-questionid="'+a+'"]').slideUp();setTimeout(function(){jQuery('#cfaq_newQuestions tr[data-questionid="'+a+'"]').remove()},500);jQuery.ajax({url:ajaxurl,type:"post",data:{action:"cfaq_removeQuestion",questionID:a},success:function(){}})};